(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{118:function(module,__webpack_exports__,__webpack_require__){"use strict";var react=__webpack_require__(0),react_default=__webpack_require__.n(react),DeleteButton=function(){return react_default.a.createElement("svg",{className:"rp-delete",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},react_default.a.createElement("g",{"data-name":"Layer 2"},react_default.a.createElement("g",{"data-name":"trash-2"},react_default.a.createElement("rect",{width:"24",height:"24",opacity:"0"}),react_default.a.createElement("path",{d:"M21 6h-5V4.33A2.42 2.42 0 0 0 13.5 2h-3A2.42 2.42 0 0 0 8 4.33V6H3a1 1 0 0 0 0 2h1v11a3 3 0 0 0 3 3h10a3 3 0 0 0 3-3V8h1a1 1 0 0 0 0-2zM10 16a1 1 0 0 1-2 0v-4a1 1 0 0 1 2 0zm0-11.67c0-.16.21-.33.5-.33h3c.29 0 .5.17.5.33V6h-4zM16 16a1 1 0 0 1-2 0v-4a1 1 0 0 1 2 0z"}))))};__webpack_exports__.a=function(_ref){var editable=_ref.editable,annotation=_ref.annotation,_onChange=_ref.onChange,onDelete=_ref.onDelete;return react_default.a.createElement("div",{className:"rp-default-input-section"},react_default.a.createElement("input",{className:"rp-default-input-section_input",placeholder:"INPUT TAG HERE",value:annotation.comment,disabled:!editable,onChange:function onChange(e){return _onChange(e.target.value)}}),editable&&react_default.a.createElement("a",{className:"rp-default-input-section_delete",onClick:function onClick(){return onDelete()}},react_default.a.createElement(DeleteButton,null)))};try{DefaultInputSection.displayName="DefaultInputSection",DefaultInputSection.__docgenInfo={description:"",displayName:"DefaultInputSection",props:{editable:{defaultValue:null,description:"",name:"editable",required:!0,type:{name:"boolean"}},annotation:{defaultValue:null,description:"",name:"annotation",required:!0,type:{name:"IAnnotation<any>"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"(value: string) => void"}},onDelete:{defaultValue:null,description:"",name:"onDelete",required:!0,type:{name:"() => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/DefaultInputSection.tsx#DefaultInputSection"]={docgenInfo:DefaultInputSection.__docgenInfo,name:"DefaultInputSection",path:"src/DefaultInputSection.tsx#DefaultInputSection"})}catch(__react_docgen_typescript_loader_error){}},284:function(module,exports){},285:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return ReactPictureAnnotation_ReactPictureAnnotation}));var react=__webpack_require__(0),react_default=__webpack_require__.n(react),build_pdf=__webpack_require__(119),pdf_default=__webpack_require__.n(build_pdf),Shape=__webpack_require__(71);function _createForOfIteratorHelper(o,allowArrayLike){var it;if("undefined"==typeof Symbol||null==o[Symbol.iterator]){if(Array.isArray(o)||(it=function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function F(){};return{s:F,n:function n(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function e(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function s(){it=o[Symbol.iterator]()},n:function n(){var step=it.next();return normalCompletion=step.done,step},e:function e(_e2){didErr=!0,err=_e2},f:function f(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var Transformer=function Transformer(_shape,editable,getImageSize,_calculateTruePosition){var _this=this;!function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Transformer),_defineProperty(this,"id",void 0),_defineProperty(this,"shape",void 0),_defineProperty(this,"editable",void 0),_defineProperty(this,"currentNodeCenterIndex",void 0),_defineProperty(this,"calculateTruePosition",void 0),_defineProperty(this,"getImageSize",void 0),_defineProperty(this,"checkBoundary",(function(positionX,positionY){return _this.getCenterIndexByCursor(positionX,positionY)>=0})),_defineProperty(this,"startTransformation",(function(positionX,positionY){var currentCenterIndex=_this.getCenterIndexByCursor(positionX,positionY);_this.currentNodeCenterIndex=currentCenterIndex})),_defineProperty(this,"onTransformation",(function(positionX,positionY){_this.getAllCentersTable()[_this.currentNodeCenterIndex].adjust(positionX,positionY)})),_defineProperty(this,"paint",(function(canvas2D,calculateTruePosition){var allCentersTable=_this.getAllCentersTable();if(canvas2D.save(),canvas2D.fillStyle="#5c7cfa",_this.editable){var _step,_iterator=_createForOfIteratorHelper(allCentersTable);try{for(_iterator.s();!(_step=_iterator.n()).done;){var item=_step.value,_calculateTruePositio=calculateTruePosition({x:item.x-5,y:item.y-5,width:10,height:10}),x=_calculateTruePositio.x,y=_calculateTruePositio.y,width=_calculateTruePositio.width,height=_calculateTruePositio.height;canvas2D.fillRect(x,y,width,height)}}catch(err){_iterator.e(err)}finally{_iterator.f()}}canvas2D.restore()})),_defineProperty(this,"getCenterIndexByCursor",(function(positionX,positionY){return _this.getAllCentersTable().findIndex((function(item){return _this.checkEachRectBoundary(item.x,item.y,positionX,positionY)}))})),_defineProperty(this,"checkEachRectBoundary",(function(rectCenterX,rectCenterY,positionX,positionY){return Math.abs(positionX-rectCenterX)<=5&&Math.abs(positionY-rectCenterY)<=5})),_defineProperty(this,"getAllCentersTable",(function(){var shape=_this.shape,isPercentage=shape.getAnnotationData().mark.width<1&&shape.getAnnotationData().mark.height<1,_this$calculateTruePo=_this.calculateTruePosition(shape.getAnnotationData().mark),scaledX=_this$calculateTruePo.x,scaledY=_this$calculateTruePo.y,scaledWidth=_this$calculateTruePo.width,scaledHeight=_this$calculateTruePo.height,_shape$getAnnotationD=shape.getAnnotationData().mark,x=_shape$getAnnotationD.x,y=_shape$getAnnotationD.y,width=_shape$getAnnotationD.width,height=_shape$getAnnotationD.height,_this$getImageSize=_this.getImageSize(),imageWidth=_this$getImageSize.width,imageHeight=_this$getImageSize.height;return[{x:scaledX,y:scaledY,adjust:function adjust(positionX,positionY){isPercentage&&(positionX/=imageWidth,positionY/=imageHeight),shape.adjustMark({x:positionX,y:positionY,width:width+x-positionX,height:height+y-positionY})}},{x:scaledX+scaledWidth/2,y:scaledY,adjust:function adjust(_,positionY){isPercentage&&(positionY/=imageHeight),shape.adjustMark({y:positionY,height:height+y-positionY})}},{x:scaledX+scaledWidth,y:scaledY,adjust:function adjust(positionX,positionY){isPercentage&&(positionX/=imageWidth,positionY/=imageHeight),shape.adjustMark({x:x,y:positionY,width:positionX-x,height:y+height-positionY})}},{x:scaledX,y:scaledY+scaledHeight/2,adjust:function adjust(positionX){isPercentage&&(positionX/=imageWidth),shape.adjustMark({x:positionX,width:width+x-positionX})}},{x:scaledX+scaledWidth,y:scaledY+scaledHeight/2,adjust:function adjust(positionX){isPercentage&&(positionX/=imageWidth),shape.adjustMark({width:positionX-x})}},{x:scaledX,y:scaledY+scaledHeight,adjust:function adjust(positionX,positionY){isPercentage&&(positionX/=imageWidth,positionY/=imageHeight),shape.adjustMark({x:positionX,width:width+x-positionX,height:positionY-y})}},{x:scaledX+scaledWidth/2,y:scaledY+scaledHeight,adjust:function adjust(_,positionY){isPercentage&&(positionY/=imageHeight),shape.adjustMark({height:positionY-y})}},{x:scaledX+scaledWidth,y:scaledY+scaledHeight,adjust:function adjust(positionX,positionY){isPercentage&&(positionX/=imageWidth,positionY/=imageHeight),shape.adjustMark({width:positionX-x,height:positionY-y})}}]})),this.shape=_shape,this.editable=editable,this.id=_shape.getAnnotationData().id,this.getImageSize=getImageSize,this.calculateTruePosition=_calculateTruePosition};try{randomId.displayName="randomId",randomId.__docgenInfo={description:"",displayName:"randomId",props:{toString:{defaultValue:null,description:"Returns a string representation of an object.\n@param radix Specifies a radix for converting numeric values to strings. This value is only used for numbers.",name:"toString",required:!1,type:{name:"(radix?: number) => string"}},toFixed:{defaultValue:null,description:"Returns a string representing a number in fixed-point notation.\n@param fractionDigits Number of digits after the decimal point. Must be in the range 0 - 20, inclusive.",name:"toFixed",required:!0,type:{name:"(fractionDigits?: number) => string"}},toExponential:{defaultValue:null,description:"Returns a string containing a number represented in exponential notation.\n@param fractionDigits Number of digits after the decimal point. Must be in the range 0 - 20, inclusive.",name:"toExponential",required:!0,type:{name:"(fractionDigits?: number) => string"}},toPrecision:{defaultValue:null,description:"Returns a string containing a number represented either in exponential or fixed-point notation with a specified number of digits.\n@param precision Number of significant digits. Must be in the range 1 - 21, inclusive.",name:"toPrecision",required:!0,type:{name:"(precision?: number) => string"}},valueOf:{defaultValue:null,description:"Returns the primitive value of the specified object.",name:"valueOf",required:!1,type:{name:"() => number"}},toLocaleString:{defaultValue:null,description:"Converts a number to a string by using the current or specified locale.\n@param locales A locale string or array of locale strings that contain one or more language or locale tags. If you include more than one locale string, list them in descending order of priority so that the first entry is the preferred locale. If you omit this parameter, the default locale of the JavaScript runtime is used.\n@param options An object that contains one or more properties that specify comparison options.",name:"toLocaleString",required:!1,type:{name:"(locales?: string | string[], options?: NumberFormatOptions) => string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/utils/randomId.ts#randomId"]={docgenInfo:randomId.__docgenInfo,name:"randomId",path:"src/utils/randomId.ts#randomId"})}catch(__react_docgen_typescript_loader_error){}function CreatingAnnotationState_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var CreatingAnnotationState_CreatingAnnotationState=function CreatingAnnotationState(context){var _this=this;!function CreatingAnnotationState_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,CreatingAnnotationState),CreatingAnnotationState_defineProperty(this,"context",void 0),CreatingAnnotationState_defineProperty(this,"onMouseDown",(function(){})),CreatingAnnotationState_defineProperty(this,"onMouseMove",(function(positionX,positionY){var _this$context=_this.context,shapes=_this$context.shapes,onShapeChange=_this$context.onShapeChange;if(shapes.length>0){var currentShape=shapes.find((function(el){return el.getAnnotationData().id===_this.context.pendingShapeId}));if(currentShape){var _currentShape$getAnno2=currentShape.getAnnotationData().mark,x=_currentShape$getAnno2.x,y=_currentShape$getAnno2.y;currentShape.adjustMark({width:positionX-x,height:positionY-y})}}onShapeChange()})),CreatingAnnotationState_defineProperty(this,"onMouseUp",(function(){var _this$context2=_this.context,shapes=_this$context2.shapes,onShapeChange=_this$context2.onShapeChange,setAnnotationState=_this$context2.setAnnotationState,onDelete=_this$context2.onDelete,getOriginalImageSize=_this$context2.getOriginalImageSize,_this$context2$props=_this$context2.props,onAnnotationCreate=_this$context2$props.onAnnotationCreate,usePercentage=_this$context2$props.usePercentage,data=shapes.find((function(el){return el.getAnnotationData().id===_this.context.pendingShapeId}));if(data)if(data&&0!==data.getAnnotationData().mark.width&&0!==data.getAnnotationData().mark.height){var _data$getAnnotationDa=data.getAnnotationData().mark,x=_data$getAnnotationDa.x,y=_data$getAnnotationDa.y,width=_data$getAnnotationDa.width,height=_data$getAnnotationDa.height;if(usePercentage){var origSize=getOriginalImageSize();x/=origSize.width,y/=origSize.height,width/=origSize.width,height/=origSize.height}data.getAnnotationData().mark.x=x+Math.min(0,width),data.getAnnotationData().mark.y=y+Math.min(0,height),data.getAnnotationData().mark.width=Math.abs(width),data.getAnnotationData().mark.height=Math.abs(height),_this.context.selectedId=data.getAnnotationData().id,onAnnotationCreate&&onAnnotationCreate(data.getAnnotationData())}else onDelete(_this.context.pendingShapeId),_this.context.selectedId=null;else _this.context.pendingShapeId=null,_this.context.selectedId=null;setAnnotationState(new DefaultAnnotationState_DefaultAnnotationState(_this.context)),onShapeChange()})),CreatingAnnotationState_defineProperty(this,"onMouseLeave",(function(){return _this.onMouseUp()})),this.context=context};function DraggingAnnotationState_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var DraggingAnnotationState_DraggingAnnotationState=function DraggingAnnotationState(context){var _this=this;!function DraggingAnnotationState_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,DraggingAnnotationState),DraggingAnnotationState_defineProperty(this,"hasMoved",void 0),DraggingAnnotationState_defineProperty(this,"context",void 0),DraggingAnnotationState_defineProperty(this,"onMouseDown",(function(){})),DraggingAnnotationState_defineProperty(this,"onMouseMove",(function(positionX,positionY){var _this$context=_this.context,shapes=_this$context.shapes,selectedId=_this$context.selectedId,currentShape=shapes.find((function(el){return el.getAnnotationData().id===selectedId}));_this.hasMoved=!0,currentShape.onDrag(positionX,positionY)})),DraggingAnnotationState_defineProperty(this,"onMouseUp",(function(){var _this$context2=_this.context,shapes=_this$context2.shapes,setAnnotationState=_this$context2.setAnnotationState,selectedId=_this$context2.selectedId,onAnnotationUpdate=_this$context2.props.onAnnotationUpdate;(setAnnotationState(new DefaultAnnotationState_DefaultAnnotationState(_this.context)),onAnnotationUpdate&&_this.hasMoved)&&onAnnotationUpdate(shapes.find((function(el){return el.getAnnotationData().id===selectedId})).getAnnotationData())})),DraggingAnnotationState_defineProperty(this,"onMouseLeave",(function(){return _this.onMouseUp()})),this.context=context,this.hasMoved=!1};function TransfromationState_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var TransfromationState_TransformationState=function TransformationState(context){var _this=this;!function TransfromationState_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,TransformationState),TransfromationState_defineProperty(this,"context",void 0),TransfromationState_defineProperty(this,"onMouseDown",(function(){})),TransfromationState_defineProperty(this,"onMouseMove",(function(positionX,positionY){var currentTransformer=_this.context.currentTransformer;currentTransformer&&currentTransformer.onTransformation(positionX,positionY)})),TransfromationState_defineProperty(this,"onMouseUp",(function(){var _this$context=_this.context,shapes=_this$context.shapes,setAnnotationState=_this$context.setAnnotationState,selectedId=_this$context.selectedId,onAnnotationUpdate=_this$context.props.onAnnotationUpdate;if(setAnnotationState(new DefaultAnnotationState_DefaultAnnotationState(_this.context)),onAnnotationUpdate){var currentShape=shapes.find((function(el){return el.getAnnotationData().id===selectedId}));currentShape&&onAnnotationUpdate(currentShape.getAnnotationData())}})),TransfromationState_defineProperty(this,"onMouseLeave",(function(){return _this.onMouseUp()})),this.context=context};function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function DefaultAnnotationState_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return DefaultAnnotationState_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return DefaultAnnotationState_arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function DefaultAnnotationState_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function DefaultAnnotationState_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var DefaultAnnotationState_DefaultAnnotationState=function DefaultAnnotationState(context){var _this=this;!function DefaultAnnotationState_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,DefaultAnnotationState),DefaultAnnotationState_defineProperty(this,"context",void 0),DefaultAnnotationState_defineProperty(this,"hasMoved",!1),DefaultAnnotationState_defineProperty(this,"hasClicked",!1),DefaultAnnotationState_defineProperty(this,"hasSelected",!1),DefaultAnnotationState_defineProperty(this,"onMouseMove",(function(positionX,positionY){_this.hasClicked&&(_this.hasMoved=!0),_this.context.props.hoverable&&_this.checkSelectedId(positionX,positionY)})),DefaultAnnotationState_defineProperty(this,"onMouseUp",(function(){_this.hasMoved||_this.hasSelected||!_this.hasClicked||(_this.context.selectedId=null),_this.context.onShapeChange(),_this.hasMoved=!1,_this.hasClicked=!1,_this.hasSelected=!1})),DefaultAnnotationState_defineProperty(this,"onMouseLeave",(function(){_this.hasClicked=!1,_this.hasMoved=!1,_this.hasSelected=!1})),DefaultAnnotationState_defineProperty(this,"onMouseDown",(function(positionX,positionY){_this.hasClicked=!0;var _this$context=_this.context,shapes=_this$context.shapes,currentTransformer=_this$context.currentTransformer,onShapeChange=_this$context.onShapeChange,setState=_this$context.setAnnotationState,_this$context$props=_this$context.props,editable=_this$context$props.editable,creatable=_this$context$props.creatable;if(currentTransformer&&currentTransformer.checkBoundary(positionX,positionY))return currentTransformer.startTransformation(positionX,positionY),void setState(new TransfromationState_TransformationState(_this.context));for(var i=shapes.length-1;i>=0;i--)if(shapes[i].checkBoundary(positionX,positionY,_this.context.calculateShapePositionNoOffset)){_this.context.selectedId!==shapes[i].getAnnotationData().id&&(_this.hasSelected=!0),_this.context.selectedId=shapes[i].getAnnotationData().id;var selectedShape=_slicedToArray(shapes.splice(i,1),1)[0];return shapes.push(selectedShape),onShapeChange(),void(editable&&(_this.context.currentTransformer=new Transformer(shapes[i],editable,_this.context.getOriginalImageSize,_this.context.calculateShapePositionNoOffset),selectedShape.onDragStart(positionX,positionY),setState(new DraggingAnnotationState_DraggingAnnotationState(_this.context))))}if(editable||creatable){var newShapeId=function(){for(var len=arguments.length>0&&void 0!==arguments[0]?arguments[0]:6,chars="ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz2345678",maxPos=chars.length,id="",i=0;i<len;i++)id+=chars.charAt(Math.floor(Math.random()*maxPos));return id}();_this.context.shapes.push(new Shape.a({id:newShapeId,mark:{x:positionX,y:positionY,width:0,height:0,type:"RECT"}},onShapeChange,_this.context.getOriginalImageSize)),_this.context.pendingShapeId=newShapeId,setState(new CreatingAnnotationState_CreatingAnnotationState(_this.context))}})),DefaultAnnotationState_defineProperty(this,"checkSelectedId",(function(positionX,positionY){for(var _this$context2=_this.context,shapes=_this$context2.shapes,onShapeChange=_this$context2.onShapeChange,i=shapes.length-1;i>=0;i--)if(shapes[i].checkBoundary(positionX,positionY,_this.context.calculateShapePositionNoOffset,(shapes[i].getAnnotationData().mark.strokeWidth||4)+10)){var id=shapes[i].getAnnotationData().id;return void(_this.context.selectedId!==id&&(_this.context.selectedId=id,onShapeChange()))}_this.context.selectedId&&(_this.context.selectedId=null,onShapeChange())})),this.context=context,this.hasMoved=!1,this.hasSelected=!1,this.hasClicked=!1},DefaultInputSection=__webpack_require__(118);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach((function(key){ReactPictureAnnotation_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}function ReactPictureAnnotation_createForOfIteratorHelper(o,allowArrayLike){var it;if("undefined"==typeof Symbol||null==o[Symbol.iterator]){if(Array.isArray(o)||(it=function ReactPictureAnnotation_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return ReactPictureAnnotation_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ReactPictureAnnotation_arrayLikeToArray(o,minLen)}(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function F(){};return{s:F,n:function n(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function e(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function s(){it=o[Symbol.iterator]()},n:function n(){var step=it.next();return normalCompletion=step.done,step},e:function e(_e2){didErr=!0,err=_e2},f:function f(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function ReactPictureAnnotation_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function ReactPictureAnnotation_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?_assertThisInitialized(self):call}function _assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function ReactPictureAnnotation_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}pdf_default.a.GlobalWorkerOptions.workerSrc="https://cdf-hub-bundles.cogniteapp.com/dependencies/pdfjs-dist@2.4.456/build/pdf.worker.min.js";var defaultState={scale:1,originX:0,originY:0},ReactPictureAnnotation_ReactPictureAnnotation=function(_React$Component){!function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(ReactPictureAnnotation,_React$Component);var _super=_createSuper(ReactPictureAnnotation);function ReactPictureAnnotation(){var _this;ReactPictureAnnotation_classCallCheck(this,ReactPictureAnnotation);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return ReactPictureAnnotation_defineProperty(_assertThisInitialized(_this=_super.call.apply(_super,[this].concat(args))),"shapes",[]),ReactPictureAnnotation_defineProperty(_assertThisInitialized(_this),"currentTransformer",void 0),ReactPictureAnnotation_defineProperty(_assertThisInitialized(_this),"pendingShapeId",null),ReactPictureAnnotation_defineProperty(_assertThisInitialized(_this),"state",{inputPosition:{left:0,top:0},showInput:!1}),ReactPictureAnnotation_defineProperty(_assertThisInitialized(_this),"currentAnnotationData",[]),ReactPictureAnnotation_defineProperty(_assertThisInitialized(_this),"selectedIdTrueValue",null),ReactPictureAnnotation_defineProperty(_assertThisInitialized(_this),"canvasRef",react_default.a.createRef()),ReactPictureAnnotation_defineProperty(_assertThisInitialized(_this),"canvas2D",void 0),ReactPictureAnnotation_defineProperty(_assertThisInitialized(_this),"imageCanvasRef",react_default.a.createRef()),ReactPictureAnnotation_defineProperty(_assertThisInitialized(_this),"imageCanvas2D",void 0),ReactPictureAnnotation_defineProperty(_assertThisInitialized(_this),"currentImageElement",void 0),ReactPictureAnnotation_defineProperty(_assertThisInitialized(_this),"currentAnnotationState",new DefaultAnnotationState_DefaultAnnotationState(_assertThisInitialized(_this))),ReactPictureAnnotation_defineProperty(_assertThisInitialized(_this),"scaleState",defaultState),ReactPictureAnnotation_defineProperty(_assertThisInitialized(_this),"startDrag",void 0),ReactPictureAnnotation_defineProperty(_assertThisInitialized(_this),"lastPinchLength",void 0),ReactPictureAnnotation_defineProperty(_assertThisInitialized(_this),"_PDF_DOC",void 0),ReactPictureAnnotation_defineProperty(_assertThisInitialized(_this),"componentDidMount",_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var currentCanvas,currentImageCanvas;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(currentCanvas=_this.canvasRef.current,currentImageCanvas=_this.imageCanvasRef.current,!_this.props.pdf){_context.next=7;break}return _context.next=5,pdf_default.a.getDocument({url:_this.props.pdf}).promise;case 5:_this._PDF_DOC=_context.sent,_this.props.onPDFLoaded&&_this.props.onPDFLoaded({pages:_this._PDF_DOC.numPages});case 7:currentCanvas&&currentImageCanvas&&(_this.setCanvasDPI(),_this.canvas2D=currentCanvas.getContext("2d"),_this.imageCanvas2D=currentImageCanvas.getContext("2d"),_this.onImageChange(),currentCanvas.addEventListener("wheel",_this.onWheel,{passive:!1})),_this.syncAnnotationData(),_this.syncSelectedId();case 10:case"end":return _context.stop()}}),_callee)})))),ReactPictureAnnotation_defineProperty(_assertThisInitialized(_this),"componentDidUpdate",function(){var _ref2=_asyncToGenerator(regeneratorRuntime.mark((function _callee2(prevProps){var _this$props,width,height,image,pdf,page;return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:if(_this$props=_this.props,width=_this$props.width,height=_this$props.height,image=_this$props.image,pdf=_this$props.pdf,page=_this$props.page,prevProps.width===width&&prevProps.height===height||(_this.setCanvasDPI(),_this.onShapeChange(),_this.onImageChange()),prevProps.pdf===pdf){_context2.next=11;break}if(!pdf){_context2.next=10;break}return _context2.next=6,pdf_default.a.getDocument({url:pdf}).promise;case 6:_this._PDF_DOC=_context2.sent,_this.props.onPDFLoaded&&_this.props.onPDFLoaded({pages:_this._PDF_DOC.numPages}),_context2.next=11;break;case 10:_this._PDF_DOC=void 0;case 11:if(image&&prevProps.image!==image&&(_this.cleanImage(),_this.currentImageElement||_this.reset(),_this.currentImageElement&&image&&(_this.currentImageElement.src=image)),!pdf||prevProps.pdf===pdf&&prevProps.page===page){_context2.next=18;break}if(_this.currentImageElement||_this.reset(),!_this.currentImageElement||!_this._PDF_DOC){_context2.next=18;break}return _context2.next=17,_this.loadPDFPage();case 17:_this.currentImageElement.src=_context2.sent;case 18:_this.syncAnnotationData(),_this.syncSelectedId();case 20:case"end":return _context2.stop()}}),_callee2)})));return function(_x){return _ref2.apply(this,arguments)}}()),ReactPictureAnnotation_defineProperty(_assertThisInitialized(_this),"componentWillUnmount",(function(){_this.canvasRef.current&&_this.canvasRef.current.removeEventListener("wheel",_this.onWheel)})),ReactPictureAnnotation_defineProperty(_assertThisInitialized(_this),"calculateMousePosition",(function(positionX,positionY){var _this$scaleState=_this.scaleState,originX=_this$scaleState.originX,originY=_this$scaleState.originY,scale=_this$scaleState.scale;return{positionX:(positionX-originX)/scale,positionY:(positionY-originY)/scale}})),ReactPictureAnnotation_defineProperty(_assertThisInitialized(_this),"getOriginalImageSize",(function(){return _this.currentImageElement?{width:_this.currentImageElement.width,height:_this.currentImageElement.height}:{width:1,height:1}})),ReactPictureAnnotation_defineProperty(_assertThisInitialized(_this),"calculateShapePositionNoOffset",(function(shapeData){var x=shapeData.x,y=shapeData.y,width=shapeData.width,height=shapeData.height,scaledX=x,scaledWidth=width,scaledY=y,scaledHeight=height;return _this.currentImageElement&&width<1&&height<1&&width>0&&height>0&&(scaledX=x*_this.currentImageElement.width,scaledWidth=width*_this.currentImageElement.width,scaledY=y*_this.currentImageElement.height,scaledHeight=height*_this.currentImageElement.height),{x:scaledX,y:scaledY,width:scaledWidth,height:scaledHeight}})),ReactPictureAnnotation_defineProperty(_assertThisInitialized(_this),"calculateShapePosition",(function(shapeData){var _this$scaleState2=_this.scaleState,originX=_this$scaleState2.originX,originY=_this$scaleState2.originY,scale=_this$scaleState2.scale,_this$calculateShapeP=_this.calculateShapePositionNoOffset(shapeData);return{x:_this$calculateShapeP.x*scale+originX,y:_this$calculateShapeP.y*scale+originY,width:_this$calculateShapeP.width*scale,height:_this$calculateShapeP.height*scale}})),ReactPictureAnnotation_defineProperty(_assertThisInitialized(_this),"setAnnotationState",(function(annotationState){_this.currentAnnotationState=annotationState})),ReactPictureAnnotation_defineProperty(_assertThisInitialized(_this),"onShapeChange",(function(){if(_this.canvas2D&&_this.canvasRef.current){_this.canvas2D.clearRect(0,0,_this.canvasRef.current.width,_this.canvasRef.current.height);var hasSelectedItem=!1;if(1===_this.getOriginalImageSize().width)return;var _step,_iterator=ReactPictureAnnotation_createForOfIteratorHelper(_this.shapes);try{for(_iterator.s();!(_step=_iterator.n()).done;){var item=_step.value,isSelected=item.getAnnotationData().id===_this.selectedId,_item$paint=item.paint(_this.canvas2D,_this.calculateShapePosition,isSelected,_this.props.drawLabel),x=_item$paint.x,y=_item$paint.y,height=_item$paint.height,width=_item$paint.width;if(isSelected){_this.currentTransformer&&_this.currentTransformer.id===item.getAnnotationData().id||(_this.currentTransformer=new Transformer(item,_this.props.editable,_this.getOriginalImageSize,_this.calculateShapePositionNoOffset)),hasSelectedItem=!0,_this.currentTransformer.paint(_this.canvas2D,_this.calculateShapePosition);var _this$props2=_this.props,containerWidth=_this$props2.width,containerHeight=_this$props2.height,leftOfMiddle=x<containerWidth/2,topOfMiddle=y<containerHeight/2,_item$getAnnotationDa=item.getAnnotationData().mark.strokeWidth,strokeWidth=void 0===_item$getAnnotationDa?4:_item$getAnnotationDa,margin=strokeWidth+10;_this.setState({showInput:!0,inputPosition:_objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread({},leftOfMiddle?{left:x}:{right:containerWidth-(x+width)}),topOfMiddle?{top:y+height+strokeWidth}:{bottom:-y+strokeWidth}),topOfMiddle?{paddingTop:margin}:{paddingBottom:margin}),topOfMiddle&&{maxHeight:"calc(".concat(_this.props.height,"px - ").concat(y+height+2*margin,"px)")}),!topOfMiddle&&{maxHeight:"calc(".concat(y-2*margin,"px)")}),{},{overflow:"visible",zIndex:1e3})})}}}catch(err){_iterator.e(err)}finally{_iterator.f()}hasSelectedItem||_this.setState({showInput:!1,inputComment:""})}_this.currentAnnotationData=_this.shapes.map((function(item){return item.getAnnotationData()}));var onChange=_this.props.onChange;onChange&&onChange(_this.currentAnnotationData)})),ReactPictureAnnotation_defineProperty(_assertThisInitialized(_this),"onDelete",(function(){var id=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_this.selectedId,_this$props3=_this.props,onAnnotationDelete=_this$props3.onAnnotationDelete,editable=_this$props3.editable;if(editable){var deleteTarget=_this.shapes.findIndex((function(shape){return shape.getAnnotationData().id===id}));if(deleteTarget>=0){_this.shapes.splice(deleteTarget,1),_this.onShapeChange();var _annotation=_this.shapes.find((function(shape){return shape.getAnnotationData().id===id}));onAnnotationDelete&&_annotation&&onAnnotationDelete(_annotation.getAnnotationData())}_this.selectedId=null,_this.onShapeChange()}})),ReactPictureAnnotation_defineProperty(_assertThisInitialized(_this),"zoomIn",(function(){_this.scaleState.scale>10?_this.scaleState.scale=10:_this.scaleState.scale<.1?_this.scaleState.scale=.1:(_this.scaleState.scale+=.2*_this.scaleState.scale,_this.scaleState.scale=Math.max(Math.min(_this.scaleState.scale,10),.1)),_this.setState({imageScale:_this.scaleState}),requestAnimationFrame((function(){_this.onShapeChange(),_this.onImageChange()}))})),ReactPictureAnnotation_defineProperty(_assertThisInitialized(_this),"zoomOut",(function(){_this.scaleState.scale>10?_this.scaleState.scale=10:_this.scaleState.scale<.1?_this.scaleState.scale=.1:(_this.scaleState.scale-=.2*_this.scaleState.scale,_this.scaleState.scale=Math.max(Math.min(_this.scaleState.scale,10),.1)),_this.setState({imageScale:_this.scaleState}),requestAnimationFrame((function(){_this.onShapeChange(),_this.onImageChange()}))})),ReactPictureAnnotation_defineProperty(_assertThisInitialized(_this),"reset",_asyncToGenerator(regeneratorRuntime.mark((function _callee3(){var nextImageNode,loadProperDimentions;return regeneratorRuntime.wrap((function _callee3$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:if(_this.props.onLoading(!0),nextImageNode=_this.currentImageElement||document.createElement("img"),loadProperDimentions=function loadProperDimentions(){var width=nextImageNode.width,height=nextImageNode.height,imageNodeRatio=height/width,_this$props4=_this.props,canvasWidth=_this$props4.width,canvasHeight=_this$props4.height,canvasNodeRatio=canvasHeight/canvasWidth;if(!isNaN(imageNodeRatio)&&!isNaN(canvasNodeRatio))if(imageNodeRatio<canvasNodeRatio){var scale=canvasWidth/width;_this.scaleState={originX:0,originY:(canvasHeight-scale*height)/2,scale:scale}}else{var _scale=canvasHeight/height;_this.scaleState={originX:(canvasWidth-_scale*width)/2,originY:0,scale:_scale}}_this.onImageChange(),_this.onShapeChange()},!_this.currentImageElement){_context3.next=7;break}loadProperDimentions(),_context3.next=17;break;case 7:if(nextImageNode.addEventListener("load",(function(){_this.currentImageElement=nextImageNode,loadProperDimentions()})),nextImageNode.alt="",!_this.props.image){_context3.next=13;break}nextImageNode.src=_this.props.image,_context3.next=17;break;case 13:if(!_this._PDF_DOC){_context3.next=17;break}return _context3.next=16,_this.loadPDFPage();case 16:nextImageNode.src=_context3.sent;case 17:_this.props.onLoading(!1);case 18:case"end":return _context3.stop()}}),_callee3)})))),ReactPictureAnnotation_defineProperty(_assertThisInitialized(_this),"syncAnnotationData",(function(){var annotationData=_this.props.annotationData;if(annotationData){var refreshShapesWithAnnotationData=function refreshShapesWithAnnotationData(){var nextShapes=annotationData.map((function(eachAnnotationData){return new Shape.a(eachAnnotationData,_this.onShapeChange,_this.getOriginalImageSize)}));_this.shapes=nextShapes,nextShapes.find((function(el){return el.getAnnotationData().id===_this.selectedId}))||(_this.selectedId=null),_this.onShapeChange()};if(annotationData.length!==_this.shapes.length)refreshShapesWithAnnotationData();else{var _step2,_iterator2=ReactPictureAnnotation_createForOfIteratorHelper(annotationData);try{var _loop2=function _loop2(){var annotationDataItem=_step2.value,targetShape=_this.shapes.find((function(item){return item.getAnnotationData().id===annotationDataItem.id}));return targetShape&&targetShape.equal(annotationDataItem)&&JSON.stringify(targetShape.getAnnotationData().mark)===JSON.stringify(annotationDataItem.mark)?"continue":(refreshShapesWithAnnotationData(),"break")};_loop:for(_iterator2.s();!(_step2=_iterator2.n()).done;){switch(_loop2()){case"continue":continue;case"break":break _loop}}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}}}})),ReactPictureAnnotation_defineProperty(_assertThisInitialized(_this),"syncSelectedId",(function(){var selectedId=_this.props.selectedId;selectedId&&selectedId!==_this.selectedId&&(_this.selectedId=selectedId,_this.onShapeChange())})),ReactPictureAnnotation_defineProperty(_assertThisInitialized(_this),"setCanvasDPI",(function(){var currentCanvas=_this.canvasRef.current,currentImageCanvas=_this.imageCanvasRef.current;if(currentCanvas&&currentImageCanvas){var currentCanvas2D=currentCanvas.getContext("2d"),currentImageCanvas2D=currentImageCanvas.getContext("2d");currentCanvas2D&&currentImageCanvas2D&&(currentCanvas2D.resetTransform(),currentImageCanvas2D.resetTransform(),currentCanvas2D.scale(2,2),currentImageCanvas2D.scale(2,2))}})),ReactPictureAnnotation_defineProperty(_assertThisInitialized(_this),"onInputCommentChange",(function(comment){if(_this.props.editable){var selectedShapeIndex=_this.shapes.findIndex((function(item){return item.getAnnotationData().id===_this.selectedId}));_this.shapes[selectedShapeIndex].getAnnotationData().comment=comment,_this.selectedId=null,_this.onShapeChange()}})),ReactPictureAnnotation_defineProperty(_assertThisInitialized(_this),"cleanImage",(function(){_this.imageCanvas2D&&_this.imageCanvasRef.current&&_this.imageCanvas2D.clearRect(0,0,_this.imageCanvasRef.current.width,_this.imageCanvasRef.current.height)})),ReactPictureAnnotation_defineProperty(_assertThisInitialized(_this),"onImageChange",_asyncToGenerator(regeneratorRuntime.mark((function _callee4(){var _this$scaleState3,originX,originY,scale;return regeneratorRuntime.wrap((function _callee4$(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:_this.cleanImage(),_this.imageCanvas2D&&_this.imageCanvasRef.current&&(_this$scaleState3=_this.scaleState,originX=_this$scaleState3.originX,originY=_this$scaleState3.originY,scale=_this$scaleState3.scale,_this.currentImageElement?_this.imageCanvas2D.drawImage(_this.currentImageElement,originX,originY,_this.currentImageElement.width*scale,_this.currentImageElement.height*scale):_this.reset());case 2:case"end":return _context4.stop()}}),_callee4)})))),ReactPictureAnnotation_defineProperty(_assertThisInitialized(_this),"loadPDFPage",_asyncToGenerator(regeneratorRuntime.mark((function _callee5(){var pageNum,page,viewport,canvas,ctx,data,_args5=arguments;return regeneratorRuntime.wrap((function _callee5$(_context5){for(;;)switch(_context5.prev=_context5.next){case 0:if(pageNum=_args5.length>0&&void 0!==_args5[0]?_args5[0]:_this.props.page||1,!_this._PDF_DOC){_context5.next=14;break}return _context5.next=4,_this._PDF_DOC.getPage(pageNum);case 4:return page=_context5.sent,viewport=page.getViewport({scale:Math.min(Math.max(_this.props.width/(page.view[2]/4),_this.props.height/(page.view[3]/4),1),8)}),canvas=document.createElement("canvas"),ctx=canvas.getContext("2d"),canvas.height=viewport.height,canvas.width=viewport.width,_context5.next=12,page.render({canvasContext:ctx,viewport:viewport}).promise;case 12:return data=canvas.toDataURL("image/png",1),_context5.abrupt("return",data);case 14:return _context5.abrupt("return","");case 15:case"end":return _context5.stop()}}),_callee5)})))),ReactPictureAnnotation_defineProperty(_assertThisInitialized(_this),"onMouseDown",(function(event){var _this$props5=_this.props,editable=_this$props5.editable,creatable=_this$props5.creatable,_event$nativeEvent=event.nativeEvent,offsetX=_event$nativeEvent.offsetX,offsetY=_event$nativeEvent.offsetY,_this$calculateMouseP=_this.calculateMousePosition(offsetX,offsetY),positionX=_this$calculateMouseP.positionX,positionY=_this$calculateMouseP.positionY;if(_this.currentAnnotationState.onMouseDown(positionX,positionY),!creatable&&!editable||event.shiftKey){var _this$scaleState4=_this.scaleState,originX=_this$scaleState4.originX,originY=_this$scaleState4.originY;_this.startDrag={x:offsetX,y:offsetY,originX:originX,originY:originY}}})),ReactPictureAnnotation_defineProperty(_assertThisInitialized(_this),"onMouseMove",(function(event){var _event$nativeEvent2=event.nativeEvent,offsetX=_event$nativeEvent2.offsetX,offsetY=_event$nativeEvent2.offsetY,_this$calculateMouseP2=_this.calculateMousePosition(offsetX,offsetY),positionX=_this$calculateMouseP2.positionX,positionY=_this$calculateMouseP2.positionY;_this.currentAnnotationState.onMouseMove(positionX,positionY),_this.startDrag&&(_this.scaleState.originX=_this.startDrag.originX+(offsetX-_this.startDrag.x),_this.scaleState.originY=_this.startDrag.originY+(offsetY-_this.startDrag.y),_this.setState({imageScale:_this.scaleState}),requestAnimationFrame((function(){_this.onShapeChange(),_this.onImageChange()})))})),ReactPictureAnnotation_defineProperty(_assertThisInitialized(_this),"onMouseUp",(function(){_this.currentAnnotationState.onMouseUp(),_this.startDrag=void 0})),ReactPictureAnnotation_defineProperty(_assertThisInitialized(_this),"onTouchStart",(function(event){var editable=_this.props.editable,_event$touches$=event.touches[0],clientX=_event$touches$.clientX,clientY=_event$touches$.clientY,_this$calculateMouseP3=_this.calculateMousePosition(clientX,clientY),positionX=_this$calculateMouseP3.positionX,positionY=_this$calculateMouseP3.positionY;if(_this.currentAnnotationState.onMouseDown(positionX,positionY),!editable){var touches=event.touches;if(2===touches.length)_this.lastPinchLength=getPinchLength(touches);else if(1===touches.length){_this.lastPinchLength=void 0;var _this$scaleState5=_this.scaleState,originX=_this$scaleState5.originX,originY=_this$scaleState5.originY;_this.startDrag={x:clientX,y:clientY,originX:originX,originY:originY}}}tryCancelEvent(event)})),ReactPictureAnnotation_defineProperty(_assertThisInitialized(_this),"onTouchMove",(function(event){var editable=_this.props.editable,_event$touches$2=event.touches[0],clientX=_event$touches$2.clientX,clientY=_event$touches$2.clientY,_this$calculateMouseP4=_this.calculateMousePosition(clientX,clientY),positionX=_this$calculateMouseP4.positionX,positionY=_this$calculateMouseP4.positionY;if(editable)_this.currentAnnotationState.onMouseMove(positionX,positionY);else{var touches=event.touches;2===touches.length?_this.handlePinchChange(touches):1===touches.length&&_this.startDrag&&(_this.scaleState.originX=_this.startDrag.originX+(clientX-_this.startDrag.x),_this.scaleState.originY=_this.startDrag.originY+(clientY-_this.startDrag.y),_this.setState({imageScale:_this.scaleState}),requestAnimationFrame((function(){_this.onShapeChange(),_this.onImageChange()})))}tryCancelEvent(event)})),ReactPictureAnnotation_defineProperty(_assertThisInitialized(_this),"onTouchEnd",(function(){_this.currentAnnotationState.onMouseUp(),_this.startDrag=void 0})),ReactPictureAnnotation_defineProperty(_assertThisInitialized(_this),"handlePinchChange",(function(touches){var length=getPinchLength(touches),midpoint=getPinchMidpoint(touches),scale=_this.lastPinchLength?_this.scaleState.scale*length/_this.lastPinchLength:_this.scaleState.scale;scale>10&&(scale=10),scale<.1&&(scale=.1);var _this$scaleState6=_this.scaleState,originX=_this$scaleState6.originX,originY=_this$scaleState6.originY;_this.scaleState.originX=midpoint.x-(midpoint.x-originX)/_this.scaleState.scale*scale,_this.scaleState.originY=midpoint.y-(midpoint.y-originY)/_this.scaleState.scale*scale,_this.scaleState.scale=scale,_this.setState({imageScale:_this.scaleState}),requestAnimationFrame((function(){_this.onShapeChange(),_this.onImageChange()}))})),ReactPictureAnnotation_defineProperty(_assertThisInitialized(_this),"onMouseLeave",(function(){_this.currentAnnotationState.onMouseLeave()})),ReactPictureAnnotation_defineProperty(_assertThisInitialized(_this),"onWheel",(function(event){event.preventDefault(),event.stopPropagation();var preScale=_this.scaleState.scale,offsetX=event.offsetX,offsetY=event.offsetY,ctrlKey=event.ctrlKey,deltaY=event.deltaY,deltaX=event.deltaX;if(ctrlKey){_this.scaleState.scale>10?_this.scaleState.scale=10:_this.scaleState.scale<.1?_this.scaleState.scale=.1:(_this.scaleState.scale-=.01*deltaY,_this.scaleState.scale=Math.max(Math.min(_this.scaleState.scale,10),.1));var _this$scaleState7=_this.scaleState,originX=_this$scaleState7.originX,originY=_this$scaleState7.originY,scale=_this$scaleState7.scale;_this.scaleState.originX=offsetX-(offsetX-originX)/preScale*scale,_this.scaleState.originY=offsetY-(offsetY-originY)/preScale*scale}else _this.scaleState.originX-=2*deltaX,_this.scaleState.originY-=2*deltaY;_this.setState({imageScale:_this.scaleState}),requestAnimationFrame((function(){_this.onShapeChange(),_this.onImageChange()}))})),_this}return function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Constructor}(ReactPictureAnnotation,[{key:"render",value:function render(){var _this2=this,_this$props6=this.props,width=_this$props6.width,height=_this$props6.height,renderItemPreview=_this$props6.renderItemPreview,editable=_this$props6.editable,_this$state=this.state,showInput=_this$state.showInput,inputPosition=_this$state.inputPosition;return react_default.a.createElement("div",{className:"rp-stage"},react_default.a.createElement("canvas",{style:{width:width,height:height},className:"rp-image",ref:this.imageCanvasRef,width:2*width,height:2*height}),react_default.a.createElement("canvas",{className:"rp-shapes",style:{width:width,height:height},ref:this.canvasRef,width:2*width,height:2*height,onMouseDown:this.onMouseDown,onMouseMove:this.onMouseMove,onMouseUp:this.onMouseUp,onMouseLeave:this.onMouseLeave,onTouchStart:this.onTouchStart,onTouchEnd:this.onTouchEnd,onTouchMove:this.onTouchMove}),showInput&&this.selectedItem&&react_default.a.createElement("div",{className:"rp-selected-input",style:inputPosition,onMouseEnter:function onMouseEnter(){_this2.selectedId=_this2.selectedItem.id,_this2.props.hoverable||_this2.currentAnnotationState.onMouseUp()}},renderItemPreview(editable,this.selectedItem,this.onInputCommentChange,this.onDelete)))}},{key:"selectedId",set:function set(value){var onSelect=this.props.onSelect;this.selectedIdTrueValue!==value&&onSelect(value),this.selectedIdTrueValue=value},get:function get(){return this.selectedIdTrueValue}},{key:"selectedItem",get:function get(){var _this3=this;if(this.props.annotationData)return this.props.annotationData.find((function(el){return el.id===_this3.selectedIdTrueValue}))}}]),ReactPictureAnnotation}(react_default.a.Component);ReactPictureAnnotation_defineProperty(ReactPictureAnnotation_ReactPictureAnnotation,"defaultProps",{renderItemPreview:function renderItemPreview(editable,annotation,onChange,onDelete){return react_default.a.createElement(DefaultInputSection.a,{editable:editable,annotation:annotation,onChange:onChange,onDelete:onDelete})},editable:!1,creatable:!1,drawLabel:!0,usePercentage:!0,onLoading:function onLoading(){return!0}});var getPinchMidpoint=function getPinchMidpoint(touches){var touch1=touches[0],touch2=touches[1];return{x:(touch1.clientX+touch2.clientX)/2,y:(touch1.clientY+touch2.clientY)/2}},getPinchLength=function getPinchLength(touches){var touch1=touches[0],touch2=touches[1];return Math.sqrt(Math.pow(touch1.clientY-touch2.clientY,2)+Math.pow(touch1.clientX-touch2.clientX,2))},tryCancelEvent=function tryCancelEvent(event){return!1!==event.cancelable&&(event.preventDefault(),!0)};try{getPinchMidpoint.displayName="getPinchMidpoint",getPinchMidpoint.__docgenInfo={description:"",displayName:"getPinchMidpoint",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/ReactPictureAnnotation.tsx#getPinchMidpoint"]={docgenInfo:getPinchMidpoint.__docgenInfo,name:"getPinchMidpoint",path:"src/ReactPictureAnnotation.tsx#getPinchMidpoint"})}catch(__react_docgen_typescript_loader_error){}try{getPinchLength.displayName="getPinchLength",getPinchLength.__docgenInfo={description:"",displayName:"getPinchLength",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/ReactPictureAnnotation.tsx#getPinchLength"]={docgenInfo:getPinchLength.__docgenInfo,name:"getPinchLength",path:"src/ReactPictureAnnotation.tsx#getPinchLength"})}catch(__react_docgen_typescript_loader_error){}try{tryCancelEvent.displayName="tryCancelEvent",tryCancelEvent.__docgenInfo={description:"",displayName:"tryCancelEvent",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/ReactPictureAnnotation.tsx#tryCancelEvent"]={docgenInfo:tryCancelEvent.__docgenInfo,name:"tryCancelEvent",path:"src/ReactPictureAnnotation.tsx#tryCancelEvent"})}catch(__react_docgen_typescript_loader_error){}},287:function(module,exports,__webpack_require__){__webpack_require__(288),__webpack_require__(438),module.exports=__webpack_require__(439)},354:function(module,exports){},36:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__(641);var _ReactPictureAnnotation__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(285);__webpack_require__.d(__webpack_exports__,"ReactPictureAnnotation",(function(){return _ReactPictureAnnotation__WEBPACK_IMPORTED_MODULE_1__.a}));__webpack_require__(118),__webpack_require__(71),__webpack_require__(284)},439:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),function(module){var _storybook_react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(89),req=__webpack_require__(625);Object(_storybook_react__WEBPACK_IMPORTED_MODULE_0__.configure)((function loadStories(){req.keys().forEach(req)}),module)}.call(this,__webpack_require__(224)(module))},625:function(module,exports,__webpack_require__){var map={"./index.stories.tsx":626};function webpackContext(req){var id=webpackContextResolve(req);return __webpack_require__(id)}function webpackContextResolve(req){if(!__webpack_require__.o(map,req)){var e=new Error("Cannot find module '"+req+"'");throw e.code="MODULE_NOT_FOUND",e}return map[req]}webpackContext.keys=function webpackContextKeys(){return Object.keys(map)},webpackContext.resolve=webpackContextResolve,module.exports=webpackContext,webpackContext.id=625},626:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),function(module){var _storybook_addon_a11y__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(286),_storybook_react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(89),react__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(0),react__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_2__),_storybook_addon_actions__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(90),_src__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(36);function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var defaultAnnotations=[{id:"a",comment:"Hello World",mark:{type:"RECT",width:161,height:165,x:229,y:92}},{id:"b",comment:"Hello World",mark:{type:"RECT",width:161,height:165,x:0,y:0}},{id:"test",comment:"percentages",mark:{type:"RECT",width:.2,height:.2,x:.4,y:.4}},{id:"test2",comment:"percentages 2 ",mark:{type:"RECT",width:.5,height:.1,x:.1,y:.5}}];Object(_storybook_react__WEBPACK_IMPORTED_MODULE_1__.addDecorator)((function(storyFn){return react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement("div",null,storyFn())})),Object(_storybook_react__WEBPACK_IMPORTED_MODULE_1__.storiesOf)("Annotator",module).addDecorator(_storybook_addon_a11y__WEBPACK_IMPORTED_MODULE_0__.withA11y).add("No Edit",(function(){var AnnotationComponent=function AnnotationComponent(){var _useState2=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_2__.useState)({width:window.innerWidth-16,height:window.innerHeight-16}),2),size=_useState2[0],setSize=_useState2[1],_useState4=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_2__.useState)(defaultAnnotations),2),annotationData=_useState4[0],setAnnotationData=_useState4[1],_useState6=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_2__.useState)("a"),2),selectedId=_useState6[0],setSelectedId=_useState6[1],onResize=function onResize(){setSize({width:window.innerWidth-16,height:window.innerHeight-16})};return Object(react__WEBPACK_IMPORTED_MODULE_2__.useEffect)((function(){return window.addEventListener("resize",onResize),function(){window.removeEventListener("resize",onResize)}}),[]),Object(_storybook_addon_actions__WEBPACK_IMPORTED_MODULE_3__.action)("onSelect"),react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(_src__WEBPACK_IMPORTED_MODULE_4__.ReactPictureAnnotation,{width:size.width,height:size.height,annotationData:annotationData,onChange:function onChange(data){return setAnnotationData(data)},selectedId:selectedId,onSelect:function onSelect(e){setSelectedId(e)},image:"https://unsplash.it/1200/600"})};return react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(AnnotationComponent,null)})).add("PDF",(function(){var AnnotationComponent=function AnnotationComponent(){var _useState8=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_2__.useState)({width:window.innerWidth-16,height:window.innerHeight-16}),2),size=_useState8[0],setSize=_useState8[1],_useState10=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_2__.useState)(defaultAnnotations),2),annotationData=_useState10[0],setAnnotationData=_useState10[1],_useState12=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_2__.useState)("a"),2),selectedId=_useState12[0],setSelectedId=_useState12[1],_useState14=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_2__.useState)(1),2),page=_useState14[0],setPage=_useState14[1],onResize=function onResize(){setSize({width:window.innerWidth-16,height:window.innerHeight-16})};Object(react__WEBPACK_IMPORTED_MODULE_2__.useEffect)((function(){return window.addEventListener("resize",onResize),function(){window.removeEventListener("resize",onResize)}}),[]),Object(_storybook_addon_actions__WEBPACK_IMPORTED_MODULE_3__.action)("onSelect");var _useState16=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_2__.useState)(1),2),total=_useState16[0],setTotal=_useState16[1],annotationRef=react__WEBPACK_IMPORTED_MODULE_2___default.a.createRef();return react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_2___default.a.Fragment,null,react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(_src__WEBPACK_IMPORTED_MODULE_4__.ReactPictureAnnotation,{ref:annotationRef,hoverable:!0,page:page,width:size.width,height:size.height,annotationData:annotationData,onChange:function onChange(data){return setAnnotationData(data)},selectedId:selectedId,onSelect:function onSelect(e){setSelectedId(e)},onPDFLoaded:function onPDFLoaded(_ref){var pages=_ref.pages;setTotal(pages)},pdf:"https://mozilla.github.io/pdf.js/web/compressed.tracemonkey-pldi-09.pdf"}),react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement("div",{style:{position:"absolute",bottom:12,left:"50%",right:"50%"}},react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement("button",{onClick:function onClick(){return setPage(page-1)},disabled:1===page},"Prev"),react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement("button",{onClick:function onClick(){return setPage(page+1)},disabled:page===total},"Next")))};return react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(AnnotationComponent,null)})).add("Hoverable",(function(){var AnnotationComponent=function AnnotationComponent(){var _useState18=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_2__.useState)({width:window.innerWidth-16,height:window.innerHeight-16}),2),size=_useState18[0],setSize=_useState18[1],_useState20=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_2__.useState)([{id:"a",comment:"Hello World",mark:{type:"RECT",width:161,height:165,x:229,y:92}}]),2),annotationData=_useState20[0],setAnnotationData=_useState20[1],_useState22=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_2__.useState)("a"),2),selectedId=_useState22[0],setSelectedId=_useState22[1],onResize=function onResize(){setSize({width:window.innerWidth-16,height:window.innerHeight-16})};return Object(react__WEBPACK_IMPORTED_MODULE_2__.useEffect)((function(){return window.addEventListener("resize",onResize),function(){window.removeEventListener("resize",onResize)}}),[]),Object(_storybook_addon_actions__WEBPACK_IMPORTED_MODULE_3__.action)("onSelect"),react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(_src__WEBPACK_IMPORTED_MODULE_4__.ReactPictureAnnotation,{width:size.width,height:size.height,annotationData:annotationData,onChange:function onChange(data){return setAnnotationData(data)},selectedId:selectedId,onSelect:function onSelect(e){setSelectedId(e)},hoverable:!0,image:"https://unsplash.it/1200/600"})};return react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(AnnotationComponent,null)})).add("Refresh",(function(){var AnnotationComponent=function AnnotationComponent(){var _useState24=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_2__.useState)({width:window.innerWidth-16,height:window.innerHeight-16}),2),size=_useState24[0],setSize=_useState24[1],_useState26=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_2__.useState)("https://picsum.photos/id/1/200/300"),2),image=_useState26[0],setImage=_useState26[1],_useState28=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_2__.useState)([{id:"a",comment:"Hello World",mark:{type:"RECT",width:161,height:165,x:229,y:92}}]),2),annotationData=_useState28[0],setAnnotationData=_useState28[1],_useState30=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_2__.useState)("a"),2),selectedId=_useState30[0],setSelectedId=_useState30[1],onResize=function onResize(){setSize({width:window.innerWidth-16,height:window.innerHeight-16})};return Object(react__WEBPACK_IMPORTED_MODULE_2__.useEffect)((function(){return window.addEventListener("resize",onResize),function(){window.removeEventListener("resize",onResize)}}),[]),Object(_storybook_addon_actions__WEBPACK_IMPORTED_MODULE_3__.action)("onSelect"),react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_2___default.a.Fragment,null,react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement("button",{onClick:function onClick(){return setImage("https://picsum.photos/id/".concat(Math.round(1e3*Math.random()),"/200/300"))}},"Change Image"),react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(_src__WEBPACK_IMPORTED_MODULE_4__.ReactPictureAnnotation,{width:size.width,height:size.height,annotationData:annotationData,onChange:function onChange(data){return setAnnotationData(data)},selectedId:selectedId,onSelect:function onSelect(e){setSelectedId(e)},hoverable:!0,image:image}))};return react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(AnnotationComponent,null)})).add("Editable",(function(){var AnnotationComponent=function AnnotationComponent(){var _useState32=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_2__.useState)({width:window.innerWidth-16,height:window.innerHeight-16}),2),size=_useState32[0],setSize=_useState32[1],_useState34=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_2__.useState)(defaultAnnotations),2),annotationData=_useState34[0],setAnnotationData=_useState34[1],_useState36=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_2__.useState)("a"),2),selectedId=_useState36[0],setSelectedId=_useState36[1],onResize=function onResize(){setSize({width:window.innerWidth-16,height:window.innerHeight-16})};return Object(react__WEBPACK_IMPORTED_MODULE_2__.useEffect)((function(){return window.addEventListener("resize",onResize),function(){window.removeEventListener("resize",onResize)}}),[]),react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(_src__WEBPACK_IMPORTED_MODULE_4__.ReactPictureAnnotation,{width:size.width,height:size.height,annotationData:annotationData,onChange:function onChange(data){return setAnnotationData(data)},selectedId:selectedId,onSelect:function onSelect(e){return setSelectedId(e)},editable:!0,image:"https://unsplash.it/1200/600"})};return react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(AnnotationComponent,null)})).add("Creatable",(function(){var AnnotationComponent=function AnnotationComponent(){var _useState38=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_2__.useState)({width:window.innerWidth-16,height:window.innerHeight-16}),2),size=_useState38[0],setSize=_useState38[1],_useState40=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_2__.useState)(defaultAnnotations),2),annotationData=_useState40[0],setAnnotationData=_useState40[1],_useState42=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_2__.useState)("a"),2),selectedId=_useState42[0],setSelectedId=_useState42[1],onResize=function onResize(){setSize({width:window.innerWidth-16,height:window.innerHeight-16})};return Object(react__WEBPACK_IMPORTED_MODULE_2__.useEffect)((function(){return window.addEventListener("resize",onResize),function(){window.removeEventListener("resize",onResize)}}),[]),react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(_src__WEBPACK_IMPORTED_MODULE_4__.ReactPictureAnnotation,{width:size.width,height:size.height,annotationData:annotationData,onChange:function onChange(data){return setAnnotationData(data)},selectedId:selectedId,onSelect:function onSelect(e){return setSelectedId(e)},creatable:!0,editable:!1,image:"https://unsplash.it/1200/600"})};return react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(AnnotationComponent,null)})).add("No Labels",(function(){var AnnotationComponent=function AnnotationComponent(){var _useState44=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_2__.useState)({width:window.innerWidth-16,height:window.innerHeight-16}),2),size=_useState44[0],setSize=_useState44[1],_useState46=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_2__.useState)([{id:"a",comment:"HA HA HA",mark:{type:"RECT",width:161,height:165,x:229,y:92}}]),2),annotationData=_useState46[0],setAnnotationData=_useState46[1],_useState48=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_2__.useState)("a"),2),selectedId=_useState48[0],setSelectedId=_useState48[1],onResize=function onResize(){setSize({width:window.innerWidth-16,height:window.innerHeight-16})};return Object(react__WEBPACK_IMPORTED_MODULE_2__.useEffect)((function(){return window.addEventListener("resize",onResize),function(){window.removeEventListener("resize",onResize)}}),[]),react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(_src__WEBPACK_IMPORTED_MODULE_4__.ReactPictureAnnotation,{width:size.width,height:size.height,annotationData:annotationData,onChange:function onChange(data){return setAnnotationData(data)},selectedId:selectedId,onSelect:function onSelect(e){return setSelectedId(e)},editable:!0,drawLabel:!1,image:"https://unsplash.it/1200/600"})};return react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(AnnotationComponent,null)})).add("Colors",(function(){var AnnotationComponent=function AnnotationComponent(){var _useState50=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_2__.useState)({width:window.innerWidth-16,height:window.innerHeight-16}),2),size=_useState50[0],setSize=_useState50[1],annotations=[{id:"a",comment:"HA HA HA",mark:{type:"RECT",width:161,height:165,x:229,y:92,strokeColor:"red",backgroundColor:"rgba(255,0,0,0.2)"}},{id:"b",comment:"HA HA HA 2",mark:{type:"RECT",width:116,height:116,x:429,y:192,strokeColor:"green",backgroundColor:"rgba(0,255,0,0.2)"}}],_useState52=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_2__.useState)(annotations),2),annotationData=_useState52[0],setAnnotationData=_useState52[1],_useState54=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_2__.useState)("a"),2),selectedId=_useState54[0],setSelectedId=_useState54[1],onResize=function onResize(){setSize({width:window.innerWidth-16,height:window.innerHeight-16})};Object(react__WEBPACK_IMPORTED_MODULE_2__.useEffect)((function(){return window.addEventListener("resize",onResize),function(){window.removeEventListener("resize",onResize)}}),[]);return react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_2___default.a.Fragment,null,react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement("button",{onClick:function changeColor(){annotations[0].mark.strokeColor="blue",setAnnotationData(annotations)}},"Change Color"),react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(_src__WEBPACK_IMPORTED_MODULE_4__.ReactPictureAnnotation,{width:size.width,height:size.height,annotationData:annotationData,onChange:function onChange(data){return setAnnotationData(data)},selectedId:selectedId,onSelect:function onSelect(e){return setSelectedId(e)},image:"https://unsplash.it/1200/600"}))};return react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(AnnotationComponent,null)})).add("Buttons",(function(){var AnnotationComponent=function AnnotationComponent(){var _useState56=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_2__.useState)({width:window.innerWidth-16,height:window.innerHeight-16}),2),size=_useState56[0],setSize=_useState56[1],_useState58=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_2__.useState)([{id:"a",comment:"HA HA HA",mark:{type:"RECT",width:161,height:165,x:229,y:92}},{id:"b",comment:"HA HA HA 2",mark:{type:"RECT",width:116,height:116,x:429,y:192}}]),2),annotationData=_useState58[0],setAnnotationData=_useState58[1],_useState60=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_2__.useState)("a"),2),selectedId=_useState60[0],setSelectedId=_useState60[1],onResize=function onResize(){setSize({width:window.innerWidth-16,height:window.innerHeight-16})};Object(react__WEBPACK_IMPORTED_MODULE_2__.useEffect)((function(){return window.addEventListener("resize",onResize),function(){window.removeEventListener("resize",onResize)}}),[]);var annotationRef=react__WEBPACK_IMPORTED_MODULE_2___default.a.createRef();return react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_2___default.a.Fragment,null,react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(_src__WEBPACK_IMPORTED_MODULE_4__.ReactPictureAnnotation,{width:size.width,height:size.height,annotationData:annotationData,onChange:function onChange(data){return setAnnotationData(data)},selectedId:selectedId,onSelect:function onSelect(e){return setSelectedId(e)},image:"https://unsplash.it/1200/600",ref:annotationRef}),react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement("div",{style:{position:"absolute",zIndex:1e3}},react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement("button",{onClick:function onClick(){annotationRef.current&&annotationRef.current.zoomIn()}},"Zoom In"),react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement("button",{onClick:function onClick(){annotationRef.current&&annotationRef.current.zoomOut()}},"Zoom Out"),react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement("button",{onClick:function onClick(){annotationRef.current&&annotationRef.current.reset()}},"Reset")))};return react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(AnnotationComponent,null)}))}.call(this,__webpack_require__(224)(module))},641:function(module,exports,__webpack_require__){var api=__webpack_require__(642),content=__webpack_require__(643);"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.i,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},643:function(module,exports,__webpack_require__){(exports=__webpack_require__(644)(!1)).push([module.i,".rp-stage {\n  position: relative;\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto,\n    Oxygen-Sans, Ubuntu, Cantarell, 'Helvetica Neue', Helvetica, Arial,\n    sans-serif;\n}\n\n.rp-image {\n  position: absolute;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  left: 0;\n  overflow: hidden;\n}\n\n.rp-shapes {\n  position: absolute;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  left: 0;\n}\n\n.rp-selected-input {\n  position: absolute;\n}\n\n.rp-delete {\n  width: 20px;\n  height: 20px;\n  fill: white;\n}\n\n.rp-delete-section {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.rp-default-input-section {\n  display: flex;\n  align-items: stretch;\n  background-color: #3384ff;\n  border: none;\n  border-radius: 5px;\n}\n\n.rp-default-input-section input {\n  padding: 10px;\n  color: white;\n  background: transparent;\n  border: 0;\n  outline: none;\n}\n\n.rp-default-input-section input::-moz-placeholder {\n  color: #94bfff;\n}\n\n.rp-default-input-section input:-ms-input-placeholder {\n  color: #94bfff;\n}\n\n.rp-default-input-section input::-ms-input-placeholder {\n  color: #94bfff;\n}\n\n.rp-default-input-section input::placeholder {\n  color: #94bfff;\n}\n\n.rp-default-input-section a {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 35px;\n  color: white;\n  font-size: 12px;\n  background-color: #3b5bdb;\n  border-radius: 0 5px 5px 0;\n  cursor: pointer;\n  transition: background-color 0.5s, color 0.5s;\n}\n\n.rp-default-input-section a:hover,\n.rp-default-input-section a:active {\n  color: #3384ff;\n  background-color: #5c7cfa;\n}\n",""]),module.exports=exports},649:function(module,exports){},650:function(module,exports){},651:function(module,exports){},652:function(module,exports){},653:function(module,exports){},71:function(module,__webpack_exports__,__webpack_require__){"use strict";function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}__webpack_require__.d(__webpack_exports__,"a",(function(){return RectShape}));var shapeStyle_padding=5,shapeStyle_fontSize=12,shapeStyle_fontColor="#212529",shapeStyle_fontBackground="#f8f9fa",shapeStyle_fontFamily="-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen-Sans, Ubuntu, Cantarell, 'Helvetica Neue', Helvetica, Arial, sans-serif",shapeStyle_shapeBackground="hsla(210, 16%, 93%, 0.2)",shapeStyle_shapeStrokeStyle="ff0000",shapeStyle_shapeShadowStyle="hsla(210, 9%, 31%, 0.35)",RectShape=function RectShape(_data,onChange,getImageSize){var _this=this;!function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,RectShape),_defineProperty(this,"annotationData",void 0),_defineProperty(this,"onChangeCallBack",void 0),_defineProperty(this,"getImageSize",void 0),_defineProperty(this,"dragStartOffset",void 0),_defineProperty(this,"onDragStart",(function(positionX,positionY){var _this$annotationData$=_this.annotationData.mark,x=_this$annotationData$.x,y=_this$annotationData$.y,width=_this$annotationData$.width,height=_this$annotationData$.height;if(width<1&&height<1){var imageSize=_this.getImageSize();_this.dragStartOffset={offsetX:positionX/imageSize.width-x,offsetY:positionY/imageSize.height-y}}else _this.dragStartOffset={offsetX:positionX-x,offsetY:positionY-y}})),_defineProperty(this,"onDrag",(function(positionX,positionY){if(_this.dragStartOffset){var _this$annotationData$2=_this.annotationData.mark,width=_this$annotationData$2.width,height=_this$annotationData$2.height;if(width<1&&height<1){var imageSize=_this.getImageSize();_this.annotationData.mark.x=positionX/imageSize.width-_this.dragStartOffset.offsetX,_this.annotationData.mark.y=positionY/imageSize.height-_this.dragStartOffset.offsetY}else _this.annotationData.mark.x=positionX-_this.dragStartOffset.offsetX,_this.annotationData.mark.y=positionY-_this.dragStartOffset.offsetY;_this.onChangeCallBack()}})),_defineProperty(this,"checkBoundary",(function(positionX,positionY,calculateTruePosition){var padding=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,_calculateTruePositio=calculateTruePosition(_this.annotationData.mark),x=_calculateTruePositio.x,y=_calculateTruePositio.y,width=_calculateTruePositio.width,height=_calculateTruePositio.height;return(positionX>x-padding&&positionX<x+width+padding||positionX<x+padding&&positionX>x+width-padding)&&(positionY>y-padding&&positionY<y+height+padding||positionY<y+padding&&positionY>y+height-padding)})),_defineProperty(this,"paint",(function(canvas2D,calculateTruePosition,selected,drawLabel){var mark=_this.annotationData.mark,_calculateTruePositio2=calculateTruePosition(mark),x=_calculateTruePositio2.x,y=_calculateTruePositio2.y,width=_calculateTruePositio2.width,height=_calculateTruePositio2.height;if(canvas2D.save(),canvas2D.shadowBlur=10,canvas2D.shadowColor=mark.shadowColor||shapeStyle_shapeShadowStyle,canvas2D.strokeStyle=mark.strokeColor||shapeStyle_shapeStrokeStyle,canvas2D.lineWidth=mark.strokeWidth||4,canvas2D.strokeRect(x-canvas2D.lineWidth/2,y-canvas2D.lineWidth/2,width+canvas2D.lineWidth,height+canvas2D.lineWidth),canvas2D.restore(),selected)canvas2D.fillStyle=mark.backgroundColor||shapeStyle_shapeBackground,canvas2D.fillRect(x-canvas2D.lineWidth/2,y-canvas2D.lineWidth/2,width+canvas2D.lineWidth,height+canvas2D.lineWidth);else{var _comment=_this.annotationData.comment;if(_comment&&drawLabel){canvas2D.font="".concat(shapeStyle_fontSize,"px ").concat(shapeStyle_fontFamily);var metrics=canvas2D.measureText(_comment);canvas2D.save(),canvas2D.fillStyle=shapeStyle_fontBackground,canvas2D.fillRect(x,y,metrics.width+2*shapeStyle_padding,shapeStyle_fontSize+2*shapeStyle_padding),canvas2D.textBaseline="top",canvas2D.fillStyle=shapeStyle_fontColor,canvas2D.fillText(_comment,x+shapeStyle_padding,y+shapeStyle_padding)}}return canvas2D.restore(),{x:x,y:y,width:width,height:height}})),_defineProperty(this,"adjustMark",(function(_ref){var _ref$x=_ref.x,x=void 0===_ref$x?_this.annotationData.mark.x:_ref$x,_ref$y=_ref.y,y=void 0===_ref$y?_this.annotationData.mark.y:_ref$y,_ref$width=_ref.width,width=void 0===_ref$width?_this.annotationData.mark.width:_ref$width,_ref$height=_ref.height,height=void 0===_ref$height?_this.annotationData.mark.height:_ref$height;width>0&&height>0&&(_this.annotationData.mark.x=x,_this.annotationData.mark.y=y,_this.annotationData.mark.width=width,_this.annotationData.mark.height=height,_this.onChangeCallBack())})),_defineProperty(this,"getAnnotationData",(function(){return _this.annotationData})),_defineProperty(this,"setComment",(function(comment){_this.annotationData.comment=comment})),_defineProperty(this,"equal",(function(data){return data.id===_this.annotationData.id&&data.comment===_this.annotationData.comment&&data.mark.x===_this.annotationData.mark.x&&data.mark.y===_this.annotationData.mark.y&&data.mark.width===_this.annotationData.mark.width&&data.mark.height===_this.annotationData.mark.height})),this.annotationData=_data,this.onChangeCallBack=onChange,this.getImageSize=getImageSize}}},[[287,1,2]]]);
//# sourceMappingURL=main.88b503bb8476b067b363.bundle.js.map